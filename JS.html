<script>
  //datepicker
  var now = new Date();
  $('.datepicker').datepicker({
    format: "yyyy-mm-dd",
    language: 'ja',
    autoclose: true
  });
  
  $('.datepicker').datepicker("setDate", now.getFullYear()+now.getMonth+now.getDate());
  console.log("test");
  $('.detail').hide();
  
  $('#Category').on('change', function(){
    var category = $(this).val();
    console.log("category "+category+" was selected");
    if(category == 'choose'){
      $('#Work').prop('disabled', true);
    }else{
      $.ajax({
        type: "POST",
        url: "",
        data: {
        
        }
      },
      success: function(param){
        var $work = $('#Work');
        var $detail = $('.detail');
        $work.empty();
        $work.append("<option selected disabled>仕事名を選択</option>");
        var work_list_categolized = work_list.filter((work) => {
          return (work.category === category);
        });
        for(var work in work_list_categolized){
          $work.append("<option value='work_"+work.row+"'>"+work.name+"</option>");
          $work.after(
            "<div id='work_"+work.row+"'class='card detail shadow-sm' point='"work.point+"'>"+
              "<div class='card-body'>"+
                "<h5>"+work.name+"</h5>"+
                "<h6>"+work.point+"</h6>"+
                "<p>"+work.description+"</p>"+
                "<button class='btn btn-success btn-lg btn-block my-3 submit' type='submit'>実行</button>"+
              "</div>"+
            "</div>"
          )
        }
      });
      $work.append("<option value='add_work'>新しい家事を登録</option>");
      $work.append("<option value='custom_work'>登録されていない家事を実行</option>");
    }
    $detail.hide();
    $work.val('仕事名を選択');
  });
  
  $('#Work').on('change', function(){
    console.log("work selected");
    var id = $('#Work').val();
    var $detail = $('#'+id);
    var point = $detail.attr('point');
    $('#Point').attr('value', point);
    $('.detail').hide();
    $detail.show();
  });

  $('input[name="user"]').on('change', function(){
    var is_input_user = false;
    if($(".user:checked").length > 0){
      is_input_user = true;
    }else{
      is_input_user = false;
    }
    $('.submit').prop("disabled", !is_input_user);
  });
  
  $('input[type="checkbox"]').on('change', function(){
    var name = $(this).val();
    $('#custom_work_user_'+name).prop('checked', $(this).prop("checked"));
  });

</script>